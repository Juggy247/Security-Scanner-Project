
    
    <html>
    <head>
        <title>Security Report</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
                background: #f5f5f5;
                padding: 20px;
            }
            .container { 
                max-width: 900px;
                margin: 0 auto;
                background: white;
                border-radius: 15px;
                box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                overflow: hidden;
            }
            .header {
                padding: 30px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                text-align: center;
            }
            .header h1 {
                font-size: 28px;
                margin-bottom: 10px;
            }
            .header .url {
                font-size: 14px;
                opacity: 0.9;
                word-break: break-all;
            }
            
            .verdict-box {
                padding: 30px;
                text-align: center;
                border-bottom: 2px solid #f0f0f0;
            }
            .verdict-box.suspicious {
                background: #fff5f5;
                border-left: 5px solid #e53e3e;
            }
            .verdict-box.safe {
                background: #f0fff4;
                border-left: 5px solid #38a169;
            }
            .verdict-box.warning {
                background: #fffaf0;
                border-left: 5px solid #dd6b20;
            }
            .verdict-emoji {
                font-size: 64px;
                margin-bottom: 15px;
            }
            .verdict-title {
                font-size: 32px;
                font-weight: bold;
                margin-bottom: 10px;
            }
            .verdict-message {
                font-size: 16px;
                color: #666;
                max-width: 600px;
                margin: 0 auto;
            }
            
            .issue-summary {
                padding: 20px 30px;
                background: #f9f9f9;
                display: flex;
                justify-content: center;
                gap: 30px;
                flex-wrap: wrap;
            }
            .issue-count {
                text-align: center;
            }
            .issue-count-num {
                font-size: 32px;
                font-weight: bold;
                display: block;
            }
            .issue-count-label {
                font-size: 12px;
                text-transform: uppercase;
                color: #666;
            }
            .critical { color: #e53e3e; }
            .high { color: #dd6b20; }
            .medium { color: #d69e2e; }
            .low { color: #3182ce; }
            
            .issues-section {
                padding: 30px;
            }
            .issue-category {
                margin-bottom: 30px;
            }
            .category-title {
                font-size: 20px;
                font-weight: bold;
                margin-bottom: 15px;
                padding-bottom: 10px;
                border-bottom: 2px solid #f0f0f0;
            }
            .issue-item {
                background: #f9f9f9;
                padding: 20px;
                margin-bottom: 15px;
                border-radius: 10px;
                border-left: 4px solid #ccc;
            }
            .issue-item.critical { border-left-color: #e53e3e; background: #fff5f5; }
            .issue-item.high { border-left-color: #dd6b20; background: #fffaf0; }
            .issue-item.medium { border-left-color: #d69e2e; background: #fffff0; }
            .issue-item.low { border-left-color: #3182ce; background: #f0f9ff; }
            
            .issue-type {
                font-weight: bold;
                font-size: 16px;
                margin-bottom: 8px;
            }
            .issue-description {
                color: #555;
                margin-bottom: 8px;
                font-size: 14px;
            }
            .issue-risk {
                color: #666;
                font-size: 13px;
                font-style: italic;
            }
            
            .actions {
                padding: 30px;
                background: #f9f9f9;
                text-align: center;
            }
            .btn {
                display: inline-block;
                padding: 12px 30px;
                margin: 0 10px;
                border-radius: 8px;
                text-decoration: none;
                font-weight: bold;
                transition: transform 0.2s;
            }
            .btn:hover {
                transform: translateY(-2px);
            }
            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }
            .btn-secondary {
                background: #e2e8f0;
                color: #4a5568;
            }
            
            .no-issues {
                padding: 40px;
                text-align: center;
                color: #38a169;
                font-size: 18px;
            }
            
            /* Improved Details Styles */
            .detailed-data {
                padding: 30px;
                background: #f9f9f9;
            }
            .section-block {
                background: white;
                border-radius: 10px;
                padding: 20px;
                margin-bottom: 20px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            }
            .section-header {
                font-size: 20px;
                font-weight: bold;
                margin-bottom: 15px;
                color: #333;
                display: flex;
                align-items: center;
                gap: 10px;
                padding-bottom: 10px;
                border-bottom: 2px solid #f0f0f0;
            }
            .info-grid {
                display: grid;
                grid-template-columns: 200px 1fr;
                gap: 15px;
                padding: 10px 0;
            }
            .info-label {
                font-weight: 600;
                color: #555;
            }
            .info-value {
                color: #333;
            }
            .status-pass { color: #28a745; font-weight: 600; }
            .status-fail { color: #dc3545; font-weight: 600; }
            .status-warning { color: #ffc107; font-weight: 600; }
            .status-info { color: #17a2b8; font-weight: 600; }
            .list-items {
                list-style: none;
                padding: 0;
            }
            .list-items li {
                padding: 5px 0;
                padding-left: 20px;
                position: relative;
            }
            .list-items li:before {
                content: "‚Ä¢";
                position: absolute;
                left: 0;
                font-weight: bold;
            }
            .list-items li.pass:before { color: #28a745; }
            .list-items li.fail:before { color: #dc3545; }
            .divider {
                height: 1px;
                background: #e0e0e0;
                margin: 15px 0;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üîê Security Report</h1>
                <div class="url">{{ url }}</div>
            </div>
            
            {% if verdict %}
            <div class="verdict-box {{ verdict_class }}">
                <div class="verdict-emoji">{{ verdict.verdict_emoji }}</div>
                <div class="verdict-title">{{ verdict.verdict }}</div>
                <div class="verdict-message">{{ verdict.verdict_message }}</div>
            </div>
            
            {% if verdict.total_issues > 0 %}
            <div class="issue-summary">
                {% if verdict.issue_counts.critical > 0 %}
                <div class="issue-count">
                    <span class="issue-count-num critical">{{ verdict.issue_counts.critical }}</span>
                    <span class="issue-count-label">Critical</span>
                </div>
                {% endif %}
                {% if verdict.issue_counts.high > 0 %}
                <div class="issue-count">
                    <span class="issue-count-num high">{{ verdict.issue_counts.high }}</span>
                    <span class="issue-count-label">High</span>
                </div>
                {% endif %}
                {% if verdict.issue_counts.medium > 0 %}
                <div class="issue-count">
                    <span class="issue-count-num medium">{{ verdict.issue_counts.medium }}</span>
                    <span class="issue-count-label">Medium</span>
                </div>
                {% endif %}
                {% if verdict.issue_counts.low > 0 %}
                <div class="issue-count">
                    <span class="issue-count-num low">{{ verdict.issue_counts.low }}</span>
                    <span class="issue-count-label">Low</span>
                </div>
                {% endif %}
            </div>
            
            <div class="issues-section">
                {% if verdict.issues.critical %}
                <div class="issue-category">
                    <div class="category-title critical">üö® Critical Issues</div>
                    {% for issue in verdict.issues.critical %}
                    <div class="issue-item critical">
                        <div class="issue-type">{{ issue.type }}</div>
                        <div class="issue-description">{{ issue.description }}</div>
                        <div class="issue-risk">üíÄ {{ issue.risk }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if verdict.issues.high %}
                <div class="issue-category">
                    <div class="category-title high">üî¥ High Severity Issues</div>
                    {% for issue in verdict.issues.high %}
                    <div class="issue-item high">
                        <div class="issue-type">{{ issue.type }}</div>
                        <div class="issue-description">{{ issue.description }}</div>
                        <div class="issue-risk">‚ö†Ô∏è {{ issue.risk }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if verdict.issues.medium %}
                <div class="issue-category">
                    <div class="category-title medium">üü° Medium Severity Issues</div>
                    {% for issue in verdict.issues.medium %}
                    <div class="issue-item medium">
                        <div class="issue-type">{{ issue.type }}</div>
                        <div class="issue-description">{{ issue.description }}</div>
                        <div class="issue-risk">‚ÑπÔ∏è {{ issue.risk }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if verdict.issues.low %}
                <div class="issue-category">
                    <div class="category-title low">üîµ Low Severity Issues</div>
                    {% for issue in verdict.issues.low %}
                    <div class="issue-item low">
                        <div class="issue-type">{{ issue.type }}</div>
                        <div class="issue-description">{{ issue.description }}</div>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% else %}
            <div class="no-issues">
                ‚úÖ No security issues detected! This website appears to be secure.
            </div>
            {% endif %}
            {% endif %}
            
            <div class="actions">
                <a href="/" class="btn btn-primary">Scan Another Site</a>
                <a href="/admin" class="btn btn-secondary">Admin Panel</a>
                <a href="#details" onclick="toggleDetails()" class="btn btn-secondary" id="detailsBtn">View Technical Details</a>
            </div>
            
            <!-- IMPROVED DETAILS SECTION (Replaces raw JSON) -->
            <div id="detailed-data" class="detailed-data" style="display: none;">
                {% include 'detailed_report.html' %}
            </div>
        </div>
        
        <script>
            function toggleDetails() {
                const detailsDiv = document.getElementById('detailed-data');
                const btn = document.getElementById('detailsBtn');
                
                if (detailsDiv.style.display === 'none') {
                    detailsDiv.style.display = 'block';
                    btn.textContent = 'Hide Technical Details';
                    detailsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                } else {
                    detailsDiv.style.display = 'none';
                    btn.textContent = 'View Technical Details';
                }
            }
        </script>
    </body>
    
